diff a/src/gallium/drivers/freedreno/a6xx/fd6_screen.cc b/src/gallium/drivers/freedreno/a6xx/fd6_screen.cc	(rejected hunks)
@@ -157,9 +157,14 @@ fd6_screen_init(struct pipe_screen *pscreen)
 
    screen->max_rts = A6XX_MAX_RENDER_TARGETS;
 
-   screen->ccu_offset_bypass = screen->info->num_ccu * A6XX_CCU_DEPTH_SIZE;
-   screen->ccu_offset_gmem = (screen->gmemsize_bytes -
-         screen->info->num_ccu * A6XX_CCU_GMEM_COLOR_SIZE);
+   uint32_t depth_cache_size =
+      screen->info->num_ccu * screen->info->a6xx.sysmem_per_ccu_cache_size;
+   uint32_t color_cache_size =
+      (screen->info->num_ccu * screen->info->a6xx.sysmem_per_ccu_cache_size) /
+      (1 << screen->info->a6xx.gmem_ccu_color_cache_fraction);
+
+   screen->ccu_offset_bypass = depth_cache_size;
+   screen->ccu_offset_gmem = screen->gmemsize_bytes - color_cache_size;
 
    /* Currently only FB_READ forces GMEM path, mostly because we'd have to
     * deal with cmdstream patching otherwise..
